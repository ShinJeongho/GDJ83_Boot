<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.winter.app.qna.QnaMapper">
  
    <!-- 게시글 목록 조회 -->
    <select id="getList" resultType="QnaVO" parameterType="Pager">
        SELECT * FROM QNA 
        <where>
        <if test="kind == 'k1'">
        	BOARD_WRITER LIKE CONCAT('%',#{search},'%')
        </if>
        
        <if test="kind == 'k2'">
        	BOARD_CONTENTS LIKE CONCAT('%',#{search},'%')
        </if>
        
        <if test="kind == 'k3'">
        	BOARD_TITLE LIKE CONCAT('%',#{search},'%')
        </if>
        </where>
        ORDER BY BOARD_NUM DESC
        LIMIT #{startRow}, #{perPage}
    </select>
  
  	<insert id="add" parameterType="QnaVO" useGeneratedKeys="true" keyProperty="boardNum">		
        INSERT INTO QNA (BOARD_NUM, BOARD_WRITER, BOARD_TITLE, BOARD_CONTENTS, CREATE_DATE, REF, STEP, DEPTH)
        VALUES (#{boardNum}, #{boardWriter}, #{boardTitle}, #{boardContents}, now(), #{ref}, #{step}, #{depth})
    </insert>
    
    <update id="refUpdate" parameterType="QnaVO">
    	UPDATE QNA
    	SET REF=#{boardNum} 
    	WHERE BOARD_NUM=#{boardNum}
    </update>
    
    <select id="getDetail" parameterType="QnaVO" resultType="QnaVO">
    	SELECT * FROM QNA WHERE BOARD_NUM=#{boardNum}    	
    </select>
  	
  
  
  
  </mapper>